generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model employee {
  id              Int            @id @default(autoincrement())
  first_name      String         @db.VarChar(191)
  last_name       String         @db.VarChar(191)
  birth_date      DateTime       @db.DateTime(0)
  email           String         @db.VarChar(191)
  gender          String         @db.VarChar(191)
  address         String         @db.VarChar(191)
  username        String         @unique @db.VarChar(191)
  password        String         @db.VarChar(191)
  auth            Int
  dep_id          Int?
  date_employed   DateTime       @db.DateTime(0)
  phone           String         @db.VarChar(191)
  status          String         @db.VarChar(191)
  role            String
  approval_docs   approval_doc[]
  dep_appr1       dep_appr[]     @relation("first_appr")
  dep_appr2       dep_appr[]     @relation("second_appr")
  dep             department?    @relation(fields: [dep_id], references: [id])
  first_receiver  notification[] @relation("first_receiver")
  second_receiver notification[] @relation("second_receiver")
  sender          notification[] @relation("sender")
  time_record     time_record[]

  @@index([dep_id], map: "employee_dep_id_fkey")
}

model department {
  id           Int            @id @default(autoincrement())
  dep_name     String         @db.VarChar(191)
  approval_doc approval_doc[]
  dep_appr     dep_appr?
  employee     employee[]
}

model dep_appr {
  id          Int        @id @default(autoincrement())
  dep_id      Int        @unique
  first_appr  Int?
  second_appr Int?
  dep         department @relation(fields: [dep_id], references: [id], onDelete: Cascade)
  emp1_appr   employee?  @relation("first_appr", fields: [first_appr], references: [id])
  emp2_appr   employee?  @relation("second_appr", fields: [second_appr], references: [id])

  @@index([first_appr], map: "dep_appr_first_appr_fkey")
  @@index([second_appr], map: "dep_appr_second_appr_fkey")
}

model leave_type {
  id            Int             @id @default(autoincrement())
  type_name     String          @db.VarChar(191)
  fixed_quota   Int?
  type          String
  approval_doc  approval_doc[]
  type_quantity type_quantity[]
}

model type_quantity {
  id       Int        @id @default(autoincrement())
  type_id  Int
  year     Int
  quantity Int
  type     leave_type @relation(fields: [type_id], references: [id], onDelete: Cascade)

  @@index([type_id], map: "type_quantity_type_id_fkey")
}

model approval_doc {
  id                 Int            @id @default(autoincrement())
  emp_id             Int
  dep_id             Int?
  type_id            Int
  start_date         DateTime       @db.DateTime(0)
  end_date           DateTime       @db.DateTime(0)
  amount             Int
  reason             String         @db.VarChar(191)
  written_place      String         @db.VarChar(191)
  backup_contact     String         @db.VarChar(191)
  attachment         String?        @db.VarChar(191)
  status             String         @db.VarChar(191)
  status_first_appr  String?        @db.VarChar(191)
  first_appr_at      DateTime?      @db.DateTime(0)
  status_second_appr String?        @db.VarChar(191)
  second_appr_at     DateTime?      @db.DateTime(0)
  dep                department?    @relation(fields: [dep_id], references: [id])
  emp                employee       @relation(fields: [emp_id], references: [id])
  type               leave_type     @relation(fields: [type_id], references: [id])
  notification       notification[] @relation("doc_id")

  @@index([dep_id], map: "approval_doc_dep_id_fkey")
  @@index([emp_id], map: "approval_doc_emp_id_fkey")
  @@index([type_id], map: "approval_doc_type_id_fkey")
}

model time_record {
  id          Int       @id @default(autoincrement())
  emp_id      Int
  date        DateTime  @db.DateTime(0)
  clock_in    DateTime  @db.DateTime(0)
  clock_out   DateTime? @db.DateTime(0)
  total_hours Decimal?  @db.Decimal(4, 2)
  emp         employee  @relation(fields: [emp_id], references: [id])

  @@index([emp_id], map: "time_record_emp_id_fkey")
}

model holiday {
  id         Int       @id @default(autoincrement())
  name       String    @db.VarChar(191)
  start_date DateTime  @unique @db.DateTime(0)
  end_date   DateTime? @unique @db.DateTime(0)
}

model notification {
  id              Int          @id @default(autoincrement())
  noti_type       String       @db.VarChar(191)
  sender_id       Int
  first_receiver  Int?
  second_receiver Int?
  doc_id          Int
  created_at      DateTime     @db.DateTime(0)
  is_seen_first   Int
  is_seen_second  Int
  docId           approval_doc @relation("doc_id", fields: [doc_id], references: [id], onDelete: Cascade)
  firstReceiver   employee?    @relation("first_receiver", fields: [first_receiver], references: [id])
  secondReceiver  employee?    @relation("second_receiver", fields: [second_receiver], references: [id])
  sender          employee     @relation("sender", fields: [sender_id], references: [id])

  @@index([doc_id], map: "notification_doc_id_fkey")
  @@index([first_receiver], map: "notification_first_receiver_fkey")
  @@index([second_receiver], map: "notification_second_receiver_fkey")
  @@index([sender_id], map: "notification_sender_id_fkey")
}

model work_hour {
  id         Int      @id
  start_time DateTime @db.Time(0)
  end_time   DateTime @db.Time(0)
}
